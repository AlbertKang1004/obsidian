### Today's Objective
- Finish 15.1
	- Local Extrema
	- Saddle Points

### Definition (Local Extrema) : $f(x, y)$

> $f$ has local maxima at a point $P_{0}$ if $f(P_{0})\geq f(P)$ for every $P$ close to $P_{0}$.
> $f$ has local minima at a point $P_{0}$ if $f(P_{0}\geq f(P))$ for every $P$ close to $P_{0}$.

$f$ has a critical point at $P_{0}$ if $\nabla f(P_{0}) =\vec{0}= \langle0, 0\rangle$
$$\begin{cases}
f_{x}(P_{0}) = 0 \text{ or undefined}  \\[6pt]
f_{y}(P_{0}) = 0 \text{ or undefined}
\end{cases}$$

### Classify Critical Points
> Theorem (Second-derivative test)

Suppose, at $(x_{0},y_{0})$, $\nabla f(x_{0}, y_{0})=0$.
Denote 
$$D(x_{0}, y_{0})=f_{xx}(x_{0}, y_{0})f_{yy}(x_{0}, y_{0})-f_{xy}(x_{0},y_{0})^2$$
the discriminant function of $f$ at $(x, y)$.
1. If $D>0$ and $f_{xx}(x_{0}, y_{0}) > 0$, then $f$ has local minimum at $(x_{0}, y_{0})$,
2. If $D<0$ then $f$ is a **saddle** at $(x_{0}, y_{0})$.
	- There, saddle implies local maximum and minimum at the same point.
3. If $D=0$, then it is inconclusive.
	- i.e. could be local maximum / minimum / saddle / none of these

> ðŸ’¡$f_{yy}$ also works when determining whether it's a local max or min!
### Example 1
Find and analyze critical points of 
$$g(x,y) = x^{2}- y^2$$
#### Solution
- $g_{x}(x,y) =2x$
- $g_{y}(x, y) = 2y$
- for critical point, $x = 0, y=0$.
Hence $(0,0)$ is only critical point of $g$.
- Along x-axis, $y= 0$
	- $g(x,0) = x^2\geq0$
- Along y-axis, $x=0$
	- $g(0, y) = -y^{2}\leq0$

### Example 2
Classify critical points of $f(x,y) = x^2+xy+y^2+y$
#### Solution
- $f_{x}= 2x+y = 0$
	- $y =-2x$
- $f_{y} = x+2y+1=0$
	- $x - 4x+1 =0$
	- $x = \displaystyle\frac{1}{3}, y =- \frac{2}{3}$
- $f_{xx} = 2$
- $f_{xy} = 2$
- $f_{yy} = 1$

Recall that the discriminant is
$$D(x_{0}, y_{0})=f_{xx}(x_{0}, y_{0})f_{yy}(x_{0}, y_{0})-f_{xy}(x_{0},y_{0})^2$$
So we get $\displaystyle D\left( \frac{1}{3} , -\frac{2}{3}\right) =f_{xx}( \frac{1}{3} , -\frac{2}{3})f_{yy}( \frac{1}{3} , -\frac{2}{3})-f_{xy}( \frac{1}{3} , -\frac{2}{3})^2$
 $\displaystyle D\left( \frac{1}{3} , -\frac{2}{3}\right) > 0, f_{xx} > 0$, so $\displaystyle\left( \frac{1}{3}, -\frac{2}{3} \right)$ is a **local minimum**.

### Example 3
Classify the critical points of 
$$\begin{align}
(i) f(x, y)&=x^4+y^4 \\[3pt]
(ii) g(x,y) &= -x^4-y^4 \\[3pt]
(iii) h(x,y) &= x^4-y^4
\end{align}
$$

#### Solution
(i)
- Critical Points
	- $f_{x} =4x^{3}= 0$
	- $f_{y} = 4y^{3}= 0$ 
- Therefore, $(0, 0) $ is a critical point
- Discriminant
	- $f_{xx} = 12x^{2}, f_{yy} = 12y^{2}, f_{xy}=0$
	- $D(0,0) = 0 \cdot 0 - 0^{2}= 0$
- Hence, we cannot conclude from the second-order test.
$$f(x,y) = x^{4}+y^{4}\geq0 = f(0,0), \quad\forall x,y\in \mathbb{R}$$
Therefore, $(0,0)$ is a **local minimum** by definition.

(ii) $(0, 0)$ is a **local max.**
(iii)
- **Critical Point**: $(x,y) = (0,0)$
- **Discriminant**: $D(0,0) = 0$
- For x-axis: $h(x, 0) = x^{4}\geq 0 = h(0,0)$ for **local minimum**.
- For y-axis: $h(0, y) = -y^{4}\leq 0  = h(0,0)$ for **local maximum**.
Hence, $(0,0)$ is a **saddle**.

### Example 4:
$$
f(x,y) = 2x^{3}- 3x^{2}y - 3x^{2}+ 6y^{2}+ 3y$$
Classify all **critical points**.

#### Solution
- **Critical Points**
- (i) $f_{x}= 6x^{2}-6xy-6x = 0$
- (ii) $f_{y} = -3x^{2}+12y+ 3 = 0$
- From (i), $6x = 0$ or $x-y-1 = 0$
- Case 1: if $6x = 0$, i.e. $x = 0$
- For (ii): $x = 0 \implies 12y + 3 = 0, y \displaystyle= -\frac{1}{4}$
- Hence $\displaystyle\left( 0, -\frac{1}{4} \right)$ is a **critical point**.
- Case 2: $x-y-1=0 \implies x=y+1$
- Substitute in (ii), 
$$
\begin{align}
(y+1)^{2}- 4y - 1 &= 0 \\[3pt]
y^{2}+ 2y + 1 - 4y - 1 &= 0 \\[3pt]
y^{2}-2y &= 0 \\[3pt]
y(y-2)& = 0
\end{align}
$$
- $\therefore y = 0$ or $y = 2$
- From $x = y + 1$
- if $y = 0, \quad x = 1$
- and $y = 2, \quad x = 3$
- **Discriminant**
$$D(x_{0}, y_{0})=f_{xx}(x_{0}, y_{0})f_{yy}(x_{0}, y_{0})-f_{xy}(x_{0},y_{0})^2$$
- $f_{xx} = 12x-6y-6$
- $f_{xy} = -6x$
- $f_{yy} = 12$
$$\begin{align}
D(x_{0}, y_{0}) &= (12x_{0}-6y_{0}-6) \cdot 12 - (-6x_{0})^2 \\[3pt]
&= 36(4x_{0} - 2y_{0}-2-x^{2}_{0})
\end{align}
$$

|               $(x_{0}, y_{0})$                | $f_{xx}(x_0, y_0)$ | $D(x_{0}, y_{0})$ |   Type    |
| :-------------------------------------------: | :----------------: | :---------------: | :-------: |
| $\left( 0,\displaystyle -\frac{1}{4} \right)$ |        $-$         |        $-$        |  Saddle   |
|                   $(1, 0)$                    |        $+$         |        $+$        | Local max |
|                   $(3, 2)$                    |        $+$         |        $-$        |  Saddle   |


